# HTTPS 란?

HTTP + Secure라는 뜻으로 HTTP의 보안적인 문제점을 수정하기위해서 나온 프로토콜이다. </br>
정확히는 HTTP + SSL or TLS 인 프로토콜이다. 또는 SSL 위에서 동작하는 HTTP이다. </br>

# HTTPS의 목적

기존 HTTP는 3가지의 보안적 문제점을 갖기때문에 이 문제들을 해결하기 위해서 HTTPS를 사용한다. </br>
(사실 암호화되지 않는 프로토콜의 문제점 3가지이기도 하다.) </br>

1. HTTP의 메세지는 암호화되어있지 않아서 통신 중간에 탈취가 가능하다. (암호화)(공격: 스니핑, 스누핑) </br>
2. HTTP는 클라이언트가 접근하는 서버가 정말로 그 서버인지 확인할 수 가 없다. (인증)(공격: 중간자 공격) </br>
3. HTTP는 메세지의 변조를 해도 방어할 수 없다. (메시지 무결성)(공격: 위변조) </br>

# HTTPS의 동작 방식

https는 총 3단계로(핸드쉐이크 → 세션 → 세션 종료)나누어진다.

## 핸드쉐이크 (악수)

1. 클라이언트가 서버에 접속한다. (client hello)
    
    이 시점에 전달하는 데이터 내용
    
    1. 클라이언트 측에서 생성한 랜덤 데이터
    2. 클라이언트가 지원하는 암호화 방식들
    3. 세션 아이디
2. 서버는 Client Hello에 응답한다. (server hello)
    
    이 시점에 전달하는 데이터 내용
    
    1. 서버측에서 생성한 랜덤 데이터
    2. 서버가 선택한 클라이언트의 암호화 방식
    3. 인증서
3. 클라이언트에서 하는일 
    1. 클라이언트가 인증서가 CA에서 발급되어있는지 확인하기위해서 브라운저에 내장되어있는 CA Public Key를 이용하여 인증서를 복호화한다.  - [자세한 내용](https://m.blog.naver.com/alice_k106/221468341565)
        
        인증서에는 2가지 내용이 포함되어있다.
        
        1. 클라이언트가 접속한 서버의 정보
        2. 서버의 공개키
    2. 1번과 2번에서 생성한 랜덤 데이터들을 조합하여 pre master secret키를 생성한다.
    3. pre master secret키를 서버의 Public Key를 이용하여 암호화하여 서버에게 전달한다.
4. 서버에서 하는 일
    1. 클라이언트가 전송한 pre master secret 값을 서버의 private key로 복호화한다.
        
        (이렇게 서버와 클라이언트 모두 pre master secret 키를 공유하였다.)
        
    2. pre master secret 값을 이용하여 master secret 값을 만들고 또 master secret 값을 이용하여 session key 값을 생성한다.
    3. session key값을 이용하여 데이터를 비대칭 방식으로 암호화 한후 데이터는 주고 받는다.
5. 클라이언트와 서버는 핸드쉐이크 단게의 종료를 서로에게 알린다.

## 세션 (접속)

실제 서버와 클라이언트가 데이터를 주고 받는 단계이다.

1. 데이터를 sessionkey값으로 암호화하고 sessionkey값을 서버의 publickey로 암호화한다.
2. 서버는 이 데이터를 받아서 privatekey를 이용하여 복호화를 진행하고 복호화된 sessionkey값으로 데이터를 복호화한다.
    - 이러한 session key 값을 사용하는 이유는 공개키 방식이 리소스 자원을 많이 사용하기 때문에 대칭키 암호화 방식을 사용합니다.

## 세션 종료 (접속 종료)

데이터 전송이 끝나면 SSL 통신이 끝났으면 서로 알려준다. </br>
통신 모두 끝나면 session key를 폐기한다

### 용어 정리

SSL: Secure Socket Layer </br>
TLS: Transport Layer Security </br>
대칭키: 하나의 키값을 이용하여 메세지를 암복호화하는 암호화 방식 </br>
공개키: 암호화와 복호화에 사용하는 키가 서로 다른 암호화 방식 </br>
CA (Certificate Authority): 인증서를 보증하는 민간 기업 </br>

인증서란? </br>
인증서의 역할:
1. 클라이언트가 접속한 서버가 신뢰할 수 있는 서버임을 보장
2. SSL통신에 사용할 공개키를 클라이언트에게 전달

인증서의 내용:
1. 클라이언트가 접속한 서버가 맞는지 확인하는 정보
2. 서버의 공개키